var I=Object.defineProperty;var U=(e,t,i)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var M=(e,t,i)=>U(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const f of o)if(f.type==="childList")for(const c of f.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const f={};return o.integrity&&(f.integrity=o.integrity),o.referrerPolicy&&(f.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?f.credentials="include":o.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function r(o){if(o.ep)return;o.ep=!0;const f=i(o);fetch(o.href,f)}})();const z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAEACAYAAAC6UvZOAAAACXBIWXMAAC4jAAAuIwF4pT92AAADE0lEQVR42u1ar2/cMBS+WCED09gGBnYbXvlgwqdp4EjZ8UqTpqOD45Uq9W8oOTAwWiVwUuENb1cwsNKCsmZnqzm5L372ixO/ZDlbsi7ny/ve8/d+2M4lWS6X1cyzbbfbmegiLHuqD7QFkM3bgrpFgAgwDoBUTwwvC7oIKwvm8/lM9onWg29CqO70gknQOw7aCBsBPt7fd49ECUIFstorQZ5dXg6UTEVRqF5fk92I3VyP53keIJ31BjXEesBQD1JbIFG8IyjCtgCzciC1uuIixQR7W5mwHCABuITDJFNbLpxTsBWTcUxh+Hogugjvp/A7eRFwk/XrB/fKVGuUn9i11pJdQa0aHNjMfvOOZkGSJKq7OOkxlAFyVVVuz+ymkzbm5nAb5CGAGwHLfl7AQOQ4KQ6ogDwnFgcnyo2vq7/dAsl3g9EvB8X1nep6+3B1pXpjvdDu3Ydy/urJ/ofTm5/4YvMgKO9vTKEe/Pz8LUnYyAEGYhJGSYQgmLDVCxDEJBz4vPBg9vezL4++OwFWq1VD2Aai0lkPZSist/efvjb4eARgY9sZSBRh/ff6/sYUvJ9gjLceBN/mCUwjPLlip1ijF2xmO0+utTC2P4DgnTmQLqyyLKt8mpRrJpPDbZCH/t3o2qGTvICByHFSHFABe+HgEOpBcIC0TTUyuVO0KWWmMUFJHFsgpV1OrWQSbc8Rwj7BYMkF0hRsZe4/mMIB1AM0F8qyNI7vljPmiiQ1Qq18Jc3GReSAwwLbvEe4Nk60HmClPPz/TJgmrz8oesmF4Ktz6qt5PLkwgeU91gNLJG7Wa+P40WLBnI1QI389gFz0zoGgcGDjgZ+DWA8ObH9we2xetZ9eMEci1DjA/gBwwccB1IR5hT8O+Cxw+T/WAw4OivNSdez7hHaq7npwPtTZOT/JSJbE80KsB2EjEXtrGL7DG84CqAmziJ8DPgsiB7N+3hqP9aCjF16uN8bxP4sjJgugJswifg74dyiQC34LIBfDxUGsB0PEwSYDz9DKBbMXpEZM68T2yhEgnhdG/vwgAkSACNCu/QOgJ/e0ZC4RhQAAAABJRU5ErkJggg==",l=document.querySelector("#canvas"),x=l.getContext("2d"),T=new Image;T.src=z;class G{constructor(){M(this,"bomb",-1);M(this,"flag",!1);M(this,"reveal",!1);M(this,"number",0)}}const E=new Map,g=32,Q=(e,t)=>{const i=Math.floor(e/g),r=Math.floor(t/g),o=`${i},${r}`;if(!E.has(o)){const f=new Array;for(let c=0;c<g*g;c++)f.push(new G);E.set(o,f)}return E.get(o)},m=(e,t)=>{const i=Q(e,t);let r=Math.floor(e%g),o=Math.floor(t%g);r<0&&(r+=g),o<0&&(o+=g);const f=r+o*g;return i[f]},j=(e,t)=>[m(e-1,t-1),m(e,t-1),m(e+1,t-1),m(e-1,t),m(e+1,t),m(e-1,t+1),m(e,t+1),m(e+1,t+1)];let B=!1,F=!1,L=0;const S=.05,X=2e-4,J=.25,P=(e,t,i=8)=>{const r=new Array;r.push([e,t,i]);let o=!0;for(let f=0;f<r.length;f++){const[c,a,u]=r[f],s=m(c,a);if(s.flag||s.reveal&&!o)continue;s.reveal||(s.reveal=!0,L++);const A=j(c,a),y=A.filter(n=>n.bomb==-1);if(!F)s.bomb=0,y.forEach(n=>n.bomb=0);else{let n=S+L*X;n>J&&(n=J),s.bomb==-1&&(s.bomb=Math.random()<n?1:0),y.forEach(q=>q.bomb=Math.random()<n?1:0)}if(s.bomb==1){B=!0;return}const C=A.filter(n=>n.bomb==1).length,D=A.filter(n=>n.flag==!0).length;s.number=C,C==D&&u>0&&(r.push([c-1,a-1,u-1]),r.push([c,a-1,u-1]),r.push([c+1,a-1,u-1]),r.push([c-1,a,u-1]),r.push([c+1,a,u-1]),r.push([c-1,a+1,u-1]),r.push([c,a+1,u-1]),r.push([c+1,a+1,u-1])),F=!0,o=!1}},Y=(e,t)=>{const i=m(e,t);i.reveal||(i.flag=!i.flag)};let b=[0,0],d=2;const p=()=>{l.width=l.clientWidth,l.height=l.clientHeight,x.imageSmoothingEnabled=!1;const e=16*d,t=Math.floor(l.width/e),i=Math.floor(l.height/e),[r,o]=b;for(let f=-1;f<=t;f++)for(let c=-1;c<=i;c++){const a=f-Math.floor(r/e),u=c-Math.floor(o/e),s=m(a,u);let A=r%e;A<0&&(A+=e);let y=o%e;y<0&&(y+=e);const C=f*e+A,D=c*e+y;let n=0;B?s.reveal?(s.number==0&&(n=15),s.number==1&&(n=14),s.number==2&&(n=13),s.number==3&&(n=12),s.number==4&&(n=11),s.number==5&&(n=10),s.number==6&&(n=9),s.number==7&&(n=8),s.number==8&&(n=7),s.bomb==1&&(n=3)):(s.bomb==1&&s.flag==!1&&(n=5),s.bomb==1&&s.flag==!0&&(n=1),s.bomb==0&&s.flag==!0&&(n=4)):s.reveal?(s.number==0&&(n=15),s.number==1&&(n=14),s.number==2&&(n=13),s.number==3&&(n=12),s.number==4&&(n=11),s.number==5&&(n=10),s.number==6&&(n=9),s.number==7&&(n=8),s.number==8&&(n=7),s.bomb==1&&(n=3)):s.flag&&(n=1),x.drawImage(T,0,n*16,16,16,C,D,e,e)}};T.onload=()=>{p()};let h=!1,w=!1,O=[0,0],v=b;l.onmousedown=e=>{h=!1,w=!0,O=[e.clientX,e.clientY],v=b};l.onmouseleave=()=>{h=!1,w=!1};l.onmousemove=e=>{if(!w)return;const[t,i]=O,[r,o]=v,f=e.clientX-t,c=e.clientY-i;Math.abs(f)>4*d&&(h=!0),Math.abs(c)>4*d&&(h=!0),h&&(b=[r+f,o+c],p())};l.onmouseup=e=>{if(w=!1,!h){if(B)return;const t=16*d;e.preventDefault();const[i,r]=b,o=Math.floor((e.offsetX-i)/t),f=Math.floor((e.offsetY-r)/t);e.button==0&&P(o,f),p()}};l.ontouchstart=e=>{h=!1,w=!0,O=[e.touches[0].clientX,e.touches[0].clientY],v=b};l.ontouchmove=e=>{if(!w)return;e.preventDefault();const[t,i]=O,[r,o]=v,f=e.touches[0].clientX-t,c=e.touches[0].clientY-i;Math.abs(f)>4*d&&(h=!0),Math.abs(c)>4*d&&(h=!0),h&&(b=[r+f,o+c],p())};l.ontouchcancel=e=>{if(w=!1,!h){if(B)return;const t=16*d;e.preventDefault();const[i,r]=b,o=Math.floor((e.touches[0].clientX-i)/t),f=Math.floor((e.touches[0].clientY-r)/t);P(o,f),p()}};l.oncontextmenu=e=>{if(B)return;const t=16*d;e.preventDefault();const[i,r]=b,o=Math.floor((e.offsetX-i)/t),f=Math.floor((e.offsetY-r)/t);Y(o,f),p()};window.onresize=()=>{p()};
